"use strict";

(function (app) {
  'use strict';

  const MAIN_NAV = '.js-main-nav';
  const MAIN_LOGO = '.js-main-logo';
  const DOCKED_CLASS = 'is-docked';

  /**
   * Main Navigation Widget
   *
   */
  app.MainNavigationWidget = class MainNavigationWidget {
    /**
     * Constructor
     *
     * @param { HTMLElement } container - container Element that widget is instantiated on
     */
    constructor(container) {
      this.container = container;
      this.mainNav = document.querySelector(MAIN_NAV);
      this.mainLogo = document.querySelector(MAIN_LOGO);
      // this.checkStickyness();

      const navObserver = new IntersectionObserver(_ref => {
        let [event] = _ref;
        return event.target.classList.toggle('isSticky', event.intersectionRatio < 1);
      }, {
        threshold: [1]
      });
      navObserver.observe(this.container);
      const logoObserver = new IntersectionObserver(entries => {
        if (!entries[0].isIntersecting) {
          this.mainNav.classList.add(DOCKED_CLASS);
          //   observer.unobserve(entry.target);
        } else {
          this.mainNav.classList.remove(DOCKED_CLASS);
        }
      }, {
        rootMargin: '0px 0px 40px 0px'
      });
      logoObserver.observe(this.mainLogo);
    }
  };
  app.widgetInitialiser.addMultipleWidgetsByName('main-navigation');
})(PULSE.app, PULSE.app.common, PULSE.core);